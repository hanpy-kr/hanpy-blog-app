---
deployment: true
category: Backend
title: 'NestJSë¡œ ê¶Œí•œ(Authorization) ê´€ë¦¬ êµ¬í˜„í•˜ê¸°'
summary: 'NestJSì—ì„œ ì‚¬ìš©ì ì¸ì¦ê³¼ ê¶Œí•œì„ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ AuthGuard, Role-Based Access Control(RBAC)ì— ëŒ€í•´ ì•Œì•„ë´…ì‹œë‹¤.'
pageKey: nestjs-authorization-guide
lng: KOR
publishedAt: 2025-04-12
# tags: [NestJS, RBAC, Authorization, Backend, ì¸ì¦, ê¶Œí•œ ê´€ë¦¬, AuthGuard]
---

# NestJSë¡œ ê¶Œí•œ(Authorization) ê´€ë¦¬ êµ¬í˜„í•˜ê¸°

ì›¹ ì„œë¹„ìŠ¤ë¥¼ ê°œë°œí•  ë•Œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ ì¤‘ í•˜ë‚˜ëŠ” ë°”ë¡œ **ê¶Œí•œ ê´€ë¦¬**ì…ë‹ˆë‹¤. íŠ¹íˆ ì—¬ëŸ¬ ì—­í• (roles)ì„ ê°€ì§„ ì‚¬ìš©ìë“¤ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°, ì–´ë–¤ ì‚¬ìš©ìì—ê²Œ ì–´ë–¤ ê¶Œí•œì„ ë¶€ì—¬í• ì§€ ëª…í™•íˆ ì •ì˜í•´ì•¼ í•˜ì£ . NestJSëŠ” ì´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í•´ê²°í•˜ê¸° ìœ„í•´ **Role-Based Access Control**(RBAC)ì™€ **AuthGuard**ë¼ëŠ” ê°•ë ¥í•œ ì¸ì¦ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

<br />

Authorization(ì¸ê°€)ì€ ì‚¬ìš©ìê°€ **ë¬´ì—‡ì„ í•  ìˆ˜ ìˆëŠ”ì§€ ê²°ì •**í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê´€ë¦¬ì(Admin)ëŠ” ê²Œì‹œê¸€ ìƒì„±, ìˆ˜ì •, ì‚­ì œê°€ ê°€ëŠ¥í•˜ì§€ë§Œ ì¼ë°˜ ì‚¬ìš©ì(User)ëŠ” ì½ê¸°ë§Œ í—ˆìš©í•˜ëŠ” ì‹ì…ë‹ˆë‹¤. NestJSì—ì„œëŠ” **Guardì™€ Custom Decorator**ë¥¼ ì´ìš©í•´ ê°„ë‹¨í•œ RBAC(Role-Based Access Control) ë°©ì‹ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 2. Role Enum ìƒì„±

ë¨¼ì € ì‹œìŠ¤í…œ ë‚´ ì—­í• ì„ ì •ì˜í•˜ëŠ” Role Enumì„ ìƒì„±í•©ë‹ˆë‹¤.

### role.enum.ts

```typescript title="Enum Role" showLineNumbers
export enum Role {
  User = 'user',
  Admin = 'admin',
}
```

> ì‹¤ë¬´ì—ì„œëŠ” ì´ ì—­í•  ì •ë³´ë¥¼ DBë‚˜ ì™¸ë¶€ ì¸ì¦ ì‹œìŠ¤í…œì—ì„œ ë°›ì•„ì˜¤ëŠ” ê²½ìš°ë„ ë§ìŠµë‹ˆë‹¤.

## 3. @Roles() ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„° ìƒì„±

í•´ë‹¹ ë°ì½”ë ˆì´í„°ëŠ” íŠ¹ì • APIê°€ ì–´ë–¤ Roleì—ê²Œë§Œ í—ˆìš©ë˜ëŠ”ì§€ ì •ì˜í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

### roles.decorator.ts

```typescript
import { SetMetadata } from '@nestjs/common'
import { Role } from './role.enum'

export const ROLES_KEY = 'roles'
export const Roles = (...roles: Role[]) => SetMetadata(ROLES_KEY, roles)
```

## 4. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‚¬ìš© ì˜ˆì‹œ

@Roles(Role.Admin) ë°ì½”ë ˆì´í„°ë¥¼ í†µí•´ **ê´€ë¦¬ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•œ API**ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```typescript
@Post()
@Roles(Role.Admin)
create(@Body() createCatDto: CreateCatDto) {
  this.catsService.create(createCatDto);
}
```

## 5. RolesGuard ìƒì„± (í•µì‹¬ ë¡œì§)

RolesGuardëŠ” í˜„ì¬ ìš”ì²­í•œ ì‚¬ìš©ìì˜ Roleì´ í•´ë‹¹ API ì ‘ê·¼ì— ì í•©í•œì§€ ê²€ì‚¬í•©ë‹ˆë‹¤.

### roles.guard.ts

```typescript
import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common'
import { Reflector } from '@nestjs/core'
import { ROLES_KEY } from './roles.decorator'
import { Role } from './role.enum'

@Injectable()
export class RolesGuard implements CanActivate {
  constructor(private reflector: Reflector) {}

  canActivate(context: ExecutionContext): boolean {
    const requiredRoles = this.reflector.getAllAndOverride<Role[]>(ROLES_KEY, [
      context.getHandler(),
      context.getClass(),
    ])

    if (!requiredRoles) {
      return true // role ì œí•œ ì—†ìŒ
    }

    const { user } = context.switchToHttp().getRequest()
    return requiredRoles.some((role) => user.roles?.includes(role))
  }
}
```

> ReflectorëŠ” ì»¤ìŠ¤í…€ ë°ì½”ë ˆì´í„°ë¡œ ì„¤ì •í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì½ì–´ì˜µë‹ˆë‹¤.

## 6. User ê°ì²´ êµ¬ì¡° ì˜ˆì‹œ

RolesGuardê°€ user.rolesë¥¼ ê²€ì‚¬í•˜ë¯€ë¡œ User ê°ì²´ ì•ˆì— roles ë°°ì—´ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

```typescript
class User {
  id: number
  username: string
  roles: Role[]
}
```

> user ì •ë³´ëŠ” JwtAuthGuard ê°™ì€ ì»¤ìŠ¤í…€ AuthGuardì—ì„œ request.userì— ì£¼ì…í•´ì•¼ í•©ë‹ˆë‹¤.

## 7. RolesGuard ì „ì—­ ë“±ë¡ (APP_GUARD)

ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ RolesGuardê°€ ì ìš©ë˜ê²Œ í•˜ë ¤ë©´ ì „ì—­ ê°€ë“œë¡œ ë“±ë¡í•©ë‹ˆë‹¤.

### app.module.ts

```typescript
import { APP_GUARD } from '@nestjs/core'

@Module({
  providers: [
    {
      provide: APP_GUARD,
      useClass: RolesGuard,
    },
  ],
})
export class AppModule {}
```

## 8. ì‹¤íŒ¨ ì‹œ ë°˜í™˜ ì˜ˆì‹œ

ê¶Œí•œì´ ì—†ëŠ” ì‚¬ìš©ìê°€ ì ‘ê·¼í•˜ë©´ NestJSê°€ ìë™ìœ¼ë¡œ ì•„ë˜ì™€ ê°™ì€ 403 ì—ëŸ¬ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

```json
{
  "statusCode": 403,
  "message": "Forbidden resource",
  "error": "Forbidden"
}
```

> ì»¤ìŠ¤í…€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì›í•˜ë©´ RolesGuardì—ì„œ ForbiddenExceptionì„ ì§ì ‘ throw í•˜ë©´ ë©ë‹ˆë‹¤.

---

## âœ… ì •ë¦¬

- @Roles()ë¡œ API ë³„ Role ì§€ì •
- RolesGuardë¡œ Role ê²€ì‚¬
- APP_GUARDë¡œ ì „ì—­ ì ìš©

RBACëŠ” í”„ë¡œì íŠ¸ì˜ ë³´ì•ˆì„±ê³¼ ê´€ë¦¬ íš¨ìœ¨ì„±ì„ ë†’ì—¬ì¤ë‹ˆë‹¤. í–¥í›„ í™•ì¥ì„±ì„ ê³ ë ¤í•´ DBë‚˜ ì™¸ë¶€ ì¸ì¦ ì‹œìŠ¤í…œê³¼ ì—°ë™í•´ë³´ëŠ” ê²ƒë„ ì¢‹ìŠµë‹ˆë‹¤.

## ğŸš© AuthGuardë€ ë¬´ì—‡ì¸ê°€ìš”?

NestJSì—ì„œëŠ” ì¸ì¦ ì—¬ë¶€ë¥¼ ê²€ì‚¬í•˜ê¸° ìœ„í•´ **AuthGuard**ë¼ëŠ” í¸ë¦¬í•œ ê°œë…ì„ ì œê³µí•©ë‹ˆë‹¤. AuthGuardëŠ” ìš”ì²­ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì— ë„ë‹¬í•˜ê¸° ì „ì— ì‹¤í–‰ë˜ì–´ ì‚¬ìš©ìì˜ ì¸ì¦ ìƒíƒœë¥¼ í™•ì¸í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ ì—­í• ì„ í•©ë‹ˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • APIì— ì ‘ê·¼í•˜ë ¤ë©´ ì‚¬ìš©ìê°€ ë°˜ë“œì‹œ ë¡œê·¸ì¸ëœ ìƒíƒœì—¬ì•¼ í•˜ëŠ” ê²½ìš°, ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì—”ë“œí¬ì¸íŠ¸ ìœ„ì— ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•˜ë©´ ë©ë‹ˆë‹¤.

<codeline>auth.guard.ts ì˜ˆì œ</codeline>

```typescript
import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common'

@Injectable()
export class AuthGuard implements CanActivate {
  canActivate(context: ExecutionContext): boolean {
    const request = context.switchToHttp().getRequest()
    const user = request.user

    return Boolean(user) // ë¡œê·¸ì¸ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ í—ˆìš©
  }
}
```

ì´ë ‡ê²Œ ì‘ì„±ëœ AuthGuardë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ë‚˜ ë©”ì„œë“œ ë ˆë²¨ì—ì„œ ì ìš©í•˜ë©´, í•´ë‹¹ APIì— ì ‘ê·¼í•˜ëŠ” ì‚¬ìš©ìì— ëŒ€í•´ ì¸ì¦ ê²€ì‚¬ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤.

---

## ğŸ” RBAC(Role-Based Access Control)ì˜ ê°œë… ì´í•´í•˜ê¸°

RBACëŠ” ì‚¬ìš©ìì˜ ì—­í• (ì˜ˆ: ê´€ë¦¬ì, ì¼ë°˜ ì‚¬ìš©ì, ê²ŒìŠ¤íŠ¸ ë“±)ì„ ê¸°ë°˜ìœ¼ë¡œ ì ‘ê·¼ ê¶Œí•œì„ ì œì–´í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì—­í• ì„ ê¸°ë°˜ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ê¶Œí•œ ê´€ë¦¬ë¥¼ ëª…í™•í•˜ê³  ê°„ë‹¨í•˜ê²Œ í•  ìˆ˜ ìˆì–´ ì‹¤ë¬´ì—ì„œ ë§¤ìš° ë§ì´ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

ê°„ë‹¨íˆ NestJSì—ì„œ RBACë¥¼ ì ìš©í•˜ëŠ” ì˜ˆì œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

```typescript
import { SetMetadata } from '@nestjs/common'

// ì—­í•  ì •ì˜
export enum Role {
  User = 'user',
  Admin = 'admin',
}

export const Roles = (...roles: string[]) => SetMetadata('roles', roles)
```

ì´ì œ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì´ ì—­í• ì„ ê°„í¸íˆ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```typescript
@Controller('users')
export class UserController {
  @Get()
  @UseGuards(AuthGuard, RolesGuard)
  @Roles('admin') // ì–´ë“œë¯¼ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
  findAll() {
    return 'ê´€ë¦¬ìë§Œ ë³¼ ìˆ˜ ìˆëŠ” ë°ì´í„°'
  }
}
```

---

## ğŸ” RBACë¥¼ íš¨ê³¼ì ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²• (RolesGuard)

NestJSì—ì„œëŠ” RBACë¥¼ ë”ìš± ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë„ë¡ **RolesGuard**ë¼ëŠ” Guardë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ êµ¬í˜„í•˜ì—¬ ì‚¬ìš©ìì˜ ì—­í• ì„ ê²€ì‚¬í•˜ê³  ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.

```typescript
import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common'

@Injectable()
export class RolesGuard implements CanActivate {
  canActivate(context: ExecutionContext): boolean {
    const roles = this.reflectRoles(context)
    if (!roles) return true // ë³„ë„ ì—­í• ì´ ì„¤ì •ë˜ì§€ ì•Šìœ¼ë©´ ì ‘ê·¼ í—ˆìš©

    const request = context.switchToHttp().getRequest()
    const user = request.user

    return roles.includes(user.role) // ì‚¬ìš©ì ì—­í• ì´ ì¼ì¹˜í•˜ë©´ ì ‘ê·¼ í—ˆìš©
  }

  private reflectRoles(context: ExecutionContext): string[] {
    return Reflect.getMetadata('roles', context.getHandler())
  }
}
```

ì´ì²˜ëŸ¼ ê°„ë‹¨í•œ ì½”ë“œë¡œ ì—­í•  ê¸°ë°˜ ê¶Œí•œ ì œì–´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âš ï¸ NestJS ê¶Œí•œ ê´€ë¦¬ ì‹œ ì£¼ì˜í•  ì 

ì‹¤ë¬´ í™˜ê²½ì—ì„œ NestJS ê¶Œí•œ ê´€ë¦¬ë¥¼ ë„ì…í•  ë•Œ ë†“ì¹˜ê¸° ì‰¬ìš´ í¬ì¸íŠ¸ë¥¼ ëª‡ ê°€ì§€ ì§šì–´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

- **AuthGuardì™€ RolesGuardë¥¼ í•­ìƒ í•¨ê»˜ ì‚¬ìš©í•˜ì„¸ìš”.**  
  ì¸ì¦(Auth)ê³¼ ê¶Œí•œ ê´€ë¦¬(Roles)ëŠ” ë¶„ë¦¬ëœ ê°œë…ì´ë©°, ë°˜ë“œì‹œ ë³„ë„ì˜ ê°€ë“œë¡œ ê´€ë¦¬í•˜ì—¬ ëª…í™•ì„±ì„ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.
- **ë¯¸ë“¤ì›¨ì–´(Guard) ì¬ì‚¬ìš©ì„±ì„ ë†’ì´ì„¸ìš”.**  
  AuthGuardì™€ RolesGuardëŠ” ê°€ëŠ¥í•œ ë²”ìš©ì ìœ¼ë¡œ ì„¤ê³„í•˜ì—¬, ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

- **ë¬´ì¡°ê±´ ì¸ì¦ì´ í•„ìš”í•œ ê²½ìš° ì „ì—­ ê°€ë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë„ ì¢‹ì€ ë°©ë²•ì…ë‹ˆë‹¤.**  
  NestJSì˜ <codeline>app.useGlobalGuards()</codeline>ë¥¼ ì‚¬ìš©í•˜ë©´, ì „ì²´ ì„œë¹„ìŠ¤ì˜ ê¸°ë³¸ ì¸ì¦ ì •ì±…ì„ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“Œ ì •ë¦¬ ë° ê²°ë¡ 

RBAC(Role-Based Access Control)ì™€ AuthGuardë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ NestJSì—ì„œ ëª…í™•í•œ ê¶Œí•œ ì œì–´ê°€ ê°€ëŠ¥í•˜ë©°, ë³µì¡í•œ ê¶Œí•œ ê´€ë¦¬ë¥¼ ë³´ë‹¤ ì†ì‰½ê³  ì•ˆì •ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³µì¡í•œ ì‚¬ìš©ì ê¶Œí•œ ì²´ê³„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•œë‹¤ë©´, ì´ ê¸€ì—ì„œ ì†Œê°œí•œ NestJSì˜ AuthGuardì™€ RBAC ë°©ì‹ì„ ì ê·¹ í™œìš©í•´ ë³´ì‹œê¸¸ ê¶Œì¥í•©ë‹ˆë‹¤.

ì´ì œ ê¶Œí•œ ê´€ë¦¬ë¡œ ê³ ë¯¼í•˜ì§€ ë§ê³ , ë”ìš± ì•ˆì „í•˜ê³  íš¨ìœ¨ì ì¸ NestJS ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!

---

## ì°¸ê³ 

- [NestJS ê³µì‹ ë¬¸ì„œ - Guards](https://docs.nestjs.com/guards)
- [NestJS ê³µì‹ ë¬¸ì„œ - Authorization (RBAC)](https://docs.nestjs.com/security/authorization)
- [Express.js CSRF Protection](https://expressjs.com/en/resources/middleware/csurf.html) (ë³´ì•ˆ ì°¸ê³ ìš©)

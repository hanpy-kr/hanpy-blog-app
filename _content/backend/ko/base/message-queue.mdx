---
deployment: true
category: Backend
title: '메시지 큐(Message Queue)'
summary: '메시지 큐(Message Queue, MQ)는 현대적인 시스템에서 서비스 간의 데이터를 효율적으로 전달하고 관리하기 위한 필수적인 도구입니다. 이 글에서는 메시지 큐를 도입해야 하는 이유와 동작 원리를 친절하고 쉽게 소개합니다.'
pageKey: message_queue_introduction
lng: KOR
publishedAt: 2025-03-24
tags: [Message Queue, MQ, RabbitMQ, Kafka, Redis, Backend]
---

# 메시지 큐(Message Queue)

백엔드 개발자로서 서비스 규모가 작을 때는 **API 호출 한 번으로 데이터가 즉시 전달되는 것이 당연한 것**처럼 느껴집니다. 하지만 서비스가 성장하고 사용자가 늘어나면서 문제가 발생합니다. 실시간 채팅 메시지, 이메일 발송, 결제 알림과 같이 순간적으로 처리할 데이터가 몰리면, 서버가 마치 명절 때 고속도로처럼 갑작스러운 교통체증을 겪게 됩니다.

<br />

이런 문제를 효과적으로 해결하는 것이 바로 **메시지 큐(Message Queue)** 입니다. 메시지 큐는 데이터를 비동기적으로 처리하고 안정적으로 전달함으로써, 서비스가 사용자 요청을 빠르게 처리하고 시스템 전체가 원활히 동작하도록 도와줍니다. 본 글에서는 메시지 큐의 필요성과 동작 원리를 간단한 비유와 함께 쉽게 설명하겠습니다.

---

## 왜 메시지 큐(Message Queue)를 사용할까?

메시지 큐는 시스템의 작업 요청을 **임시로 보관해두었다가 적절한 시점에 처리하도록 도와주는 큐(queue) 방식의 서비스**입니다. 일종의 우체국 역할이라고 생각하면 이해하기 쉽습니다. 우체국은 수신된 편지(메시지)를 우편함(큐)에 넣어두고, 우체부(Worker)가 순서대로 하나씩 배달합니다.

<br />

만약 우체국이 없다면, 모든 사람이 서로 직접 찾아가 메시지를 전달해야 합니다. 그렇게 되면 한 사람이 동시에 많은 사람에게 메시지를 전달하기 어려워지고, 전달 과정에서 혼잡과 지연이 발생할 것입니다. 이처럼 메시지 큐가 없으면 각 시스템 간 데이터 전달 과정이 복잡해지고 병목(Bottleneck)이 생기게 됩니다. 또한 우체부가 몸이 안좋아서 쉬는경우(서버가 터지는 경우)에도 우편함(큐)에는 데이터가 유지됩니다. 그리고 우체부가 다시 출근(서버 재시작)하면, 다시 메시지를 전달하면 됩니다. 이는 데이터 손실을 최소화 할 수 있음을 의미합니다.

<br />

대표적인 메시지 큐 기술로는 RabbitMQ, Kafka, Amazon SQS, Redis 등이 있고, 각각의 메시지 큐는 특정 요구사항에 맞게 설계되어 있습니다. kafka는 대규모 데이터 스트리밍에 적합하고 RabbitMQ는 간단한 메시지 전달에 특화되어 있습니다.

<br />

메시지 큐는 이렇게 **생산자와 소비자 사이의 비동기적 연결**을 제공하기 때문에, 메시지 큐를 사용하여 시스템의 안정성과 확장성을 높일 수 있습니다.

---

## 메시지 큐의 핵심 원리와 개념

메시지 큐의 핵심 개념은 크게 다음 세 가지로 요약할 수 있습니다.

- **생산자(Producer)**: 데이터를 만들어 큐에 전달하는 역할입니다. 예를 들어, 결제 시스템이 결제 완료 메시지를 생성하여 큐에 넣습니다.
- **큐(Queue)**: 메시지를 저장하는 저장소입니다. 메시지를 보관했다가 순차적으로 처리할 준비가 되었을 때 전달합니다.
- **소비자(Consumer)**: 큐에 저장된 메시지를 실제로 처리하는 역할을 합니다.

이러한 구조 덕분에 생산자와 소비자는 서로의 상태나 속도에 관계없이 독립적으로 동작할 수 있습니다. 즉, 생산자가 순간적으로 매우 많은 데이터를 생성해도 소비자가 천천히 처리할 수 있게 되고, 이로 인해 시스템 전체의 성능이 안정적으로 유지됩니다.

---

## 메시지 큐의 주요 기능과 장점

메시지 큐를 도입했을 때의 대표적인 장점은 다음과 같습니다.

- **시스템 안정성 향상**: 소비자가 일시적으로 장애가 발생하거나 처리 속도가 느려지더라도 큐에 메시지를 보관할 수 있어 데이터 유실이 없습니다.
- **비동기 처리로 빠른 응답**: 시간이 오래 걸리는 작업(이메일 발송, 파일 변환 등)을 즉시 큐에 넣고 응답을 반환하여 사용자 경험을 개선할 수 있습니다.
- **부하 분산과 확장성**: 다수의 소비자를 병렬로 배치하여 처리를 분산하면, 시스템의 전체 처리 속도를 높이고 쉽게 확장할 수 있습니다.

메시지 큐의 특징에서 알 수 있듯, 데이터베이스(DB)와의 가장 큰 차이점은 메시지 큐는 비동기 데이터 전달을 하고 데이터베이스는 영구적으로 저장하여 필요에 따라 데이터를 검색하고 수정가능합니다.

<br />

데이터베이스는 데이터를 영구적으로 저장하기 때문에 무결성과 트랜잭션 관리에 중점을 두지만, 많은 트래픽(동시성)에서는 작업 성능이 저하 될 수 있습니다. 이러한 장단점을 활용하여 메시지 큐와 데이터베이스의 역할에 맞게 사용하는 것이 필요합니다.

---

## 메시지 큐의 대표적인 예시와 도구

메시지 큐를 구현하는 대표적인 도구로는 **RabbitMQ, Kafka, Amazon SQS, Redis** 등이 있습니다. 각 도구는 용도와 목적에 따라 선택적으로 사용할 수 있습니다.

- **RabbitMQ**: 메시지의 순서를 보장하며 신뢰성 높은 메시지 전달을 지원합니다. 주로 실시간 알림, 결제 처리 등 높은 안정성이 필요한 시스템에서 자주 사용됩니다.
- **Kafka**: 대용량 데이터를 빠르게 처리하거나 스트리밍 분석이 필요한 환경에 적합하며, 특히 실시간 데이터 분석이나 이벤트 처리에 주로 활용됩니다.
- **Redis**: 빠르고 간편하게 큐를 만들 수 있어 소규모 프로젝트나 빠른 프로토타입 개발 시에 효과적입니다. 특히 BullMQ와 같은 작업 큐 라이브러리에서 자주 활용됩니다.

---

## 메시지 큐 도입 시 주의할 점

메시지 큐를 도입할 때는 다음과 같은 부분을 신중하게 고려해야 합니다.

- **데이터 중복 처리**: 메시지가 중복되어 전달될 가능성이 있으므로, 소비자는 메시지 처리 시 중복 처리를 방지하기 위한 방법(Idempotency)을 고려해야 합니다.
- **장애 복구 전략**: 메시지 처리 중 오류가 발생하면 다시 처리하거나 다른 큐로 이동하는 등 명확한 장애 복구 전략을 수립해야 합니다.
- **모니터링 및 운영**: 메시지가 큐에 쌓여 오래 대기하거나 처리되지 않는 메시지를 모니터링하고 적시에 대응할 수 있도록 설계하는 것이 중요합니다.

---

## 정리

메시지 큐는 시스템의 확장성과 안정성을 높이는 중요한 도구입니다. 메시지 큐의 개념과 원리를 잘 이해하고 실무에 적용하면, 서비스가 더 많은 사용자를 수용할 수 있게 되며 예기치 못한 장애에도 안정적인 시스템 운영이 가능합니다.

## 참고

- https://www.novell.com/documentation/extend5/Docs/help/WSSDK/tutorial/jms.html
- https://hanpy-blog.com/backend/ko/database/redis-BullMQ-01-overview
